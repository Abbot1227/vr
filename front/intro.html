<html>
  <head>
    <meta charset="utf-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="upgrade-insecure-requests"
    />

    <title>Basic Example — Networked-Aframe</title>
    <meta name="description" content="Basic Example — Networked-Aframe" />
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/rdub80/aframe-gui/master/dist/aframe-gui.min.js"></script>
    <script src="/scripts/portal.js"></script>
  </head>

  <body>
    <script>
      window.kbAbcLow = true;
      window.kbAbcHigh = false;
      var old_timestamp = null;

      // Switch from Low keyboard to High
      function switchKbToAbcHigh() {
        var keyboardAbcLow = document.getElementById("keyboardAbcLow");
        var keyboardAbcHigh = document.getElementById("keyboardAbcHigh");

        console.log(" - switchKbToAbcHigh");
        window.setTimeout(() => {
          keyboardAbcLow.setAttribute("position", "0 -10 -1");
          keyboardAbcHigh.setAttribute("position", "0 0 0");

          keyboardAbcLow.setAttribute("visible", false);
          keyboardAbcHigh.setAttribute("visible", true);
        }, 200);
      }

      // Switch from High keyboard to Low
      function switchKbToAbcLow() {
        var keyboardAbcLow = document.getElementById("keyboardAbcLow");
        var keyboardAbcHigh = document.getElementById("keyboardAbcHigh");

        console.log(" - switchKbToAbcLow");
        window.setTimeout(() => {
          keyboardAbcHigh.setAttribute("position", "0 -10 -1");
          keyboardAbcLow.setAttribute("position", "0 0 0");

          keyboardAbcHigh.setAttribute("visible", false);
          keyboardAbcLow.setAttribute("visible", true);
        }, 200);
      }
    </script>
    <!-- ============================ Start Model Selection ==========================  -->
    <a-scene id="scene">
      <a-assets>
        <img
          id="cityImage"
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/View_of_Empire_State_Building_from_Rockefeller_Center_New_York_City_dllu.jpg/800px-View_of_Empire_State_Building_from_Rockefeller_Center_New_York_City_dllu.jpg"
        />
        <a-asset-item id="base_character_gltf" src="/players/player/scene.gltf">
        </a-asset-item>
        <a-asset-item
          id="backpack_1"
          src="/models/backpack_1/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="backpack_2"
          src="/models/backpack_2/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="backpack_3"
          src="/models/backpack_3/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="backpack_4"
          src="/models/backpack_4/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="mask_1"
          src="/models/mask_1/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="mask_2"
          src="/models/mask_2/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="mask_3"
          src="/models/mask_3/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="mask_4"
          src="/models/mask_4/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="mask_5"
          src="/models/mask_5/scene.gltf"
        ></a-asset-item>
        <img id="background" src="/images/potw1405a.jpg" />
      </a-assets>

      <a-gui-label
        id="enter_nickname_label_main"
        width="4.5"
        height="0.6"
        value="Enter your nickname:"
        font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
        font-size="0.2"
        line-height="0.8"
        letter-spacing="0"
        margin="0 0 0.05 0"
        position="0 4.1 -4"
        opacity="0.55"
        background-color="#212121"
        font-color="#eb4034"
      >
      </a-gui-label>

      <a-gui-flex-container
        id="flex"
        flex-direction="column"
        justify-content="center"
        align-items="middle"
        component-padding="0.1"
        opacity="0.7"
        width="4.5"
        height="1.4"
        position="0 3.05 -4"
        rotation="0 0 0"
      >
        <a-gui-input
          id="test_input"
          width="4"
          height="0.7"
          onclick="testInputAction"
          value="_"
          valueWithoutDash=""
          font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
          font-color="#212121"
          border-color="#212121"
          border-hover-color="#424242"
          background-color="#FAFAFA"
          hover-color="#F5F5F5"
          active-color="#FFEB3B"
        >
        </a-gui-input>
      </a-gui-flex-container>

      <a-entity id="keyboard" position="0 0.75 -4" rotation="-15 0 0">
        <a-entity id="keyboardAbcLow" visible="true" position="0 0 0">
          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 1 0"
          >
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="1"
              value="1"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="2"
              value="2"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="3"
              value="3"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="4"
              value="4"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="5"
              value="5"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="6"
              value="6"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="7"
              value="7"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="8"
              value="8"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="9"
              value="9"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="0"
              value="0"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>
          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 0.5 0"
          >
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="q"
              value="q"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="w"
              value="w"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="e"
              value="e"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="r"
              value="r"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="t"
              value="t"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="y"
              value="y"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="u"
              value="u"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="i"
              value="i"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="o"
              value="o"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="p"
              value="p"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>

          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 0 0"
          >
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="a"
              value="a"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="s"
              value="s"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="d"
              value="d"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="f"
              value="f"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="g"
              value="g"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="h"
              value="h"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="j"
              value="j"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="k"
              value="k"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="l"
              value="l"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>

          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 -0.5 0"
          >
            <a-gui-button
              width="0.75"
              height="0.5"
              onclick="switchKbToAbcHigh"
              key="keyCode:16"
              id="shiftUp"
              value="^"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="z"
              value="z"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="x"
              value="x"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="c"
              value="c"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="v"
              value="v"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="b"
              value="b"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="n"
              value="n"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="m"
              value="m"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.75"
              height="0.5"
              onclick="deleteKey(this);"
              key="key:Backspace"
              value="<--"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>
        </a-entity>
        <a-entity id="keyboardAbcHigh" visible="false" position="0 -10 -1">
          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 1 0"
          >
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="1"
              value="1"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="2"
              value="2"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="3"
              value="3"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="4"
              value="4"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="5"
              value="5"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="6"
              value="6"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="7"
              value="7"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="8"
              value="8"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="9"
              value="9"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="0"
              value="0"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>
          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 0.5 0"
          >
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="Q"
              value="Q"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="W"
              value="W"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="E"
              value="E"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="R"
              value="R"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="T"
              value="T"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="Y"
              value="Y"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="U"
              value="U"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="I"
              value="I"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="O"
              value="O"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="P"
              value="P"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>

          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 0 0"
          >
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="A"
              value="A"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="S"
              value="S"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="D"
              value="D"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="F"
              value="F"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="G"
              value="G"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="H"
              value="H"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="J"
              value="J"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="K"
              value="K"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="L"
              value="L"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>

          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 -0.5 0"
          >
            <a-gui-button
              width="0.75"
              height="0.5"
              onclick="switchKbToAbcLow"
              key="keyCode:16"
              id="shiftDown"
              value="^"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="Z"
              value="Z"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="X"
              value="X"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="C"
              value="C"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="V"
              value="V"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="B"
              value="B"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="N"
              value="N"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.5"
              height="0.5"
              onclick="keypress(this);"
              key="M"
              value="M"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.75"
              height="0.5"
              onclick="deleteKey(this);"
              key="keyCode:16"
              value="<--"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>
        </a-entity>
        <a-entity id="keyboardNav">
          <a-entity
            gui-item="type: flex-container; width: 5.25; height: 0.5;"
            gui-flex-container="flexDirection: row; justifyContent: center; alignItems: normal; componentPadding: 0.1; opacity: 0.7"
            position="0 -1 0"
          >
            <a-gui-button
              width="0.7"
              height="0.5"
              id="navkbSwitch"
              onclick="keypress(this);"
              key="keyCode:9"
              value="_"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="0.75"
              height="0.5"
              id="clearAll"
              onclick="clearAll"
              key="del"
              value="del"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="2.50"
              height="0.5"
              id="space"
              onclick="keypress(this);"
              key="keyCode:32"
              value=" "
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
            <a-gui-button
              width="1.3"
              height="0.5"
              id="enter"
              onclick="enter"
              key="keyCode:13"
              value="Enter"
              font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
            ></a-gui-button>
          </a-entity>
        </a-entity>
      </a-entity>

      <script>
        // Appends character to nickname
        function keypress(el) {
          let key = el.getAttribute("value"); // Key of pressed button
          let inputLabel = document.getElementById("test_input");

          let currentText = inputLabel.getAttribute("valueWithoutDash");
          let newText = currentText + key;

          if (newText.length == 18) {
            inputLabel.setAttribute("valueWithoutDash", newText);
            inputLabel.setAttribute("value", newText);

            return;
          }
          if (newText.length > 18) {
            // Display pop up that max length is 18
            let enter_nickname_label = document.getElementById(
              "enter_nickname_label"
            );

            enter_nickname_label.setAttribute(
              "value",
              "Max nickname length is 18!"
            );
            enter_nickname_label.setAttribute("font-color", "#eb4034");

            window.setTimeout(() => {
              enter_nickname_label.setAttribute("value", "");
            }, 7000);

            return;
          } else if (newText.trim() == "") {
            // Display pop up that name cannot be empty string
            let enter_nickname_label = document.getElementById(
              "enter_nickname_label"
            );

            enter_nickname_label.setAttribute(
              "value",
              "Nickname must contain letters!"
            );
            enter_nickname_label.setAttribute("font-color", "#eb4034");

            window.setTimeout(() => {
              enter_nickname_label.setAttribute("value", "");
            }, 7000);

            return;
          }

          inputLabel.setAttribute("valueWithoutDash", newText);
          inputLabel.setAttribute("value", newText + "_");

          el.emit("mouseleave");
          el.emit("mouseenter");
        }

        // Removes last entered character
        function deleteKey(el) {
          let inputLabel = document.getElementById("test_input");

          let currentText = inputLabel.getAttribute("valueWithoutDash");
          let newText = currentText.slice(0, -1);

          inputLabel.setAttribute("value", newText + "_");
          inputLabel.setAttribute("valueWithoutDash", newText);

          el.emit("mouseleave");
          el.emit("mouseenter");
        }

        // Clears input
        function clearAll() {
          let inputLabel = document.getElementById("test_input");

          inputLabel.setAttribute("valueWithoutDash", "");
          inputLabel.setAttribute("value", "_");
        }

        function enter() {
          let nickname = document
            .getElementById("test_input")
            .getAttribute("valueWithoutDash")
            .trim();
          let camera = document.getElementById("mainCamera");

          if (nickname == "") {
            // Display pop up that name cannot be empty string
            let enter_nickname_label = document.getElementById(
              "enter_nickname_label"
            );

            enter_nickname_label.setAttribute(
              "value",
              "Nickname must contain letters!"
            );
            enter_nickname_label.setAttribute("font-color", "#eb4034");

            window.setTimeout(() => {
              enter_nickname_label.setAttribute("value", "");
            }, 7000);

            return;
          }
          localStorage.setItem("nickname", nickname);

          let bodyElement = document.getElementById("scene");
          let keyboard = document.getElementById("keyboard");
          let flex = document.getElementById("flex");
          let enter_nickname_label = document.getElementById(
            "enter_nickname_label"
          );
          let enter_nickname_label_main = document.getElementById(
            "enter_nickname_label_main"
          );
          let player = document.getElementById("player");
          let base_character = document.getElementById("base_character");
          let stand = document.getElementById("stand");
          let cust1 = document.getElementById("cust1");
          let cust2 = document.getElementById("cust2");
          let cust3 = document.getElementById("cust3");
          let cust4 = document.getElementById("cust4");
          let cust5 = document.getElementById("cust5");
          let cust6 = document.getElementById("cust6");
          let cust7 = document.getElementById("cust7");
          let cust8 = document.getElementById("cust8");
          let cust9 = document.getElementById("cust9");
          let cust10 = document.getElementById("cust10");

          window.setTimeout(() => {
            bodyElement.removeChild(keyboard);
            bodyElement.removeChild(flex);
            bodyElement.removeChild(enter_nickname_label);
            bodyElement.removeChild(enter_nickname_label_main);

            player.setAttribute("visible", "true");
            stand.setAttribute("visible", "true");
            cust1.setAttribute("visible", "true");
            cust2.setAttribute("visible", "true");
            cust3.setAttribute("visible", "true");
            cust4.setAttribute("visible", "true");
            cust5.setAttribute("visible", "true");
            cust6.setAttribute("visible", "true");
            cust7.setAttribute("visible", "true");
            cust8.setAttribute("visible", "true");
            cust9.setAttribute("visible", "true");
            cust10.setAttribute("visible", "true");

            camera.setAttribute("position", "0 2.7 -8");
            camera.setAttribute("wasd-controls-enabled", "false");
            base_character.changeBaseCharacterColor("white");
          }, 200);
        }
      </script>

      <a-gui-label
        id="enter_nickname_label"
        width="5.75"
        height="0.5"
        position="0 -1 -4"
        rotation="-15 0 0"
        value=""
        font-family="https://cdn.glitch.global/f9b5c84b-ec2d-4010-bf20-be9422712401/PressStart2P-Regular.ttf?v=1680693028620"
        font-size="0.2"
        line-height="0.8"
        letter-spacing="0"
        margin="0 0 0.05 0"
        opacity="0.6"
        background-color="#212121"
        font-color="#212121"
      >
      </a-gui-label>

      <a-camera
        me
        id="mainCamera"
        look-controls-enabled="true"
        wasd-controls-enabled="false"
        position="0 2 0"
      >
        <a-gui-cursor
          id="cursor"
          raycaster="objects: [gui-interactable]"
          fuse="true"
          fuse-timeout="500"
          color="#ECEFF1"
          hover-color="#CFD8DC"
          active-color="#607D8B"
          design="ring"
        >
          <!-- dot, ring, reticle, cross  -->
        </a-gui-cursor>
        <!-- /cursor -->
      </a-camera>

      <!-- Portal to PornHub -->
      <a-entity position="3 1.5 -8" rotation="0 -90 0" linkportal="href:/">
        <a-entity
          gltf-model="#stage1"
          position="0 0 0"
          scale="0.07 0.07 0.07"
        ></a-entity>
        <a-entity
          position="0.01 0.52 -0.32"
          scale="0.55 0.8 0.01"
          geometry="primitive: box"
          rotation="0 180 0"
          linkportal="href:/index.html"
          material="color: black"
          gui-interactable
          ><a-image
            width="0.95"
            height="0.95"
            src="#cityImage"
            position="0 0 -0.6"
          ></a-image
        ></a-entity>
      </a-entity>
      <a-gui-label
        id="Finish"
        width="1  "
        height="0.5"
        value="Finish"
        font-size="0.2"
        line-height="0.8"
        letter-spacing="0"
        margin="0 0 0.05 0"
        position="3 2.7 -8"
        rotation="0 -90 0"
        font-color="white"
        background-color="#072B73"
        opacity="0.7"
      ></a-gui-label>

      <!-- Player color customization -->
      <a-gui-label
        id="cust6"
        width="2"
        height="0.5"
        value="Player Color"
        font-size="0.2"
        line-height="0.8"
        letter-spacing="0"
        margin="0 0 0.05 0"
        position="-1.8 3.602 -10"
        rotation="0 29 0"
        font-color="white"
        background-color="#072B73"
        opacity="0.7"
        visible="false"
      ></a-gui-label>

      <a-gui-flex-container
        id="cust7"
        component-padding="0.1"
        opacity="0.7"
        flex-direction="row"
        panel-color="#072B73"
        justify-content="center"
        align-items="normal"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="-1.8 3.071 -10"
        rotation="0 29 0"
        visible="false"
      >
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('red');"
          value=""
          background-color="#e00000"
          active-color="#e00000"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('green');"
          value=""
          background-color="#0fe000"
          active-color="#0fe000"	
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('black');"
          value=""
          background-color="black"
          active-color="black"
        ></a-gui-button>
      </a-gui-flex-container>

      <a-gui-flex-container
        id="cust8"
        component-padding="0.1"
        opacity="0.7"
        flex-direction="row"
        panel-color="#072B73"
        justify-content="center"
        align-items="normal"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="-1.8 2.548 -10"
        rotation="0 29 0"
        visible="false"
      >
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('blue');"
          value=""
          background-color="blue"
          active-color="blue"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('yellow');"
          value=""
          background-color="yellow"
          active-color="yellow"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('orange');"
          value=""
          background-color="orange"
          active-color="orange"
        ></a-gui-button>
      </a-gui-flex-container>

      <a-gui-flex-container
        id="cust9"
        component-padding="0.1"
        opacity="0.7"
        flex-direction="row"
        panel-color="#072B73"
        justify-content="center"
        align-items="normal"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="-1.8 2.027 -10"
        rotation="0 29 0"
        visible="false"
      >
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('purple');"
          value=""
          background-color="purple"
          active-color="purple"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('white');"
          value=""
          background-color="white"
          active-color="white"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('brown');"
          value=""
          background-color="brown"
          active-color="brown"
        ></a-gui-button>
      </a-gui-flex-container>

      <a-gui-flex-container
        id="cust10"
        component-padding="0.1"
        opacity="0.7"
        flex-direction="row"
        panel-color="#072B73"
        justify-content="center"
        align-items="normal"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="-1.8 1.5 -10"
        rotation="0 29 0"
        visible="false"
      >
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('pink');"
          value=""
          background-color="pink"
          active-color="pink"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('lime');"
          value=""
          background-color="lime"
          active-color="lime"
        ></a-gui-button>
        <a-gui-button
          width="0.5"
          height="0.35"
          onclick="changeBaseCharacterColor('grey');"
          value=""
          background-color="grey"
          active-color="grey"
        ></a-gui-button>
      </a-gui-flex-container>

      <!-- Masks -->
      <a-gui-label
        id="cust1"
        width="2"
        height="0.5"
        value="Mask"
        font-size="0.2"
        line-height="0.8"
        letter-spacing="0"
        margin="0 0 0.05 0"
        position="1.8 3.602 -10"
        rotation="0 -29 0"
        font-color="white"
        background-color="#072B73"
        opacity="0.7"
        visible="false"
      >
      </a-gui-label>

      <!-- Buttons for choosing mask -->
      <a-gui-flex-container
        id="cust2"
        component-padding="0.1"
        opacity="0.7"
        panel-color="#072B73"
        justify-content="center"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="1.8 3.071 -10"
        rotation="0 -29 0"
        visible="false"
      >
        <a-gui-button
          width="0.75"
          height="0.25"
          onclick="prevMask();"
          key="w"
          value="<"
        ></a-gui-button>
        <a-gui-button
          width="0.75"
          height="0.25"
          onclick="nextMask();"
          key="s"
          value=">"
        ></a-gui-button>
      </a-gui-flex-container>

      <!-- Backpacks -->
      <a-gui-label
        id="cust3"
        width="2"
        height="0.5"
        value="Backpack"
        font-size="0.2"
        line-height="0.8"
        letter-spacing="0"
        margin="0 0 0.05 0"
        position="1.8 2.548 -10"
        rotation="0 -29 0"
        font-color="white"
        background-color="#072B73"
        opacity="0.7"
        visible="false"
      >
      </a-gui-label>

      <!-- Buttons for choosing backpack -->
      <a-gui-flex-container
        id="cust4"
        component-padding="0.1"
        opacity="0.7"
        panel-color="#072B73"
        justify-content="center"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="1.8 2.027 -10"
        rotation="0 -29 0"
        visible="false"
      >
        <a-gui-button
          width="0.75"
          height="0.25"
          onclick="prevBackpack();"
          key="w"
          value="<"
        ></a-gui-button>
        <a-gui-button
          width="0.75"
          height="0.25"
          onclick="nextBackpack()"
          key="s"
          value=">"
        ></a-gui-button>
      </a-gui-flex-container>

      <!-- Buttons for rotating character and changing walk animation -->
      <a-gui-flex-container
        id="cust5"
        component-padding="0.1"
        opacity="0.7"
        panel-color="#072B73"
        justify-content="center"
        panel-rounded="0.1"
        width="2"
        height="0.5"
        position="1.8 1.5 -10"
        rotation="0 -29 0"
        visible="false"
      >
        <a-gui-button
          width="0.75"
          height="0.25"
          onclick="rotateBaseCharacter();"
          key="w"
          value="Rotate"
        ></a-gui-button>
        <a-gui-button
          width="0.75"
          height="0.25"
          onclick="walkBaseCharacter();"
          key="s"
          value="Walk"
        ></a-gui-button>
      </a-gui-flex-container>

      <!-- Character customization script -->
      <script>
        // Store animation-mixer state
        var base_character_animation = "clip:Idle";
        // Store rotation state
        var rotation = 0;

        function walkBaseCharacter() {
          let base_character = document.getElementById("base_character");

          if (base_character_animation == "clip:Idle") {
            base_character.setAttribute("animation-mixer", "clip:Walk");  
            base_character_animation = "clip:Walk";
            console.log("Walking");
          } else {
            base_character.setAttribute("animation-mixer", "clip:Idle");
            base_character_animation = "clip:Idle";
            console.log("Idle");
            console.log(base_character_animation)
          }
        }

        function rotateBaseCharacter() {
          let player = document.getElementById("player");

          if (rotation == 1) {
            player.emit("pauseanim");
            rotation = 2;
          } else if (rotation == 2) {
            player.emit("resumeanim");
            rotation = 1;
          } else {
            player.emit("startanim");
            rotation = 1;
          }
        }

        var colorr = "blue";

        // Component for player to change its color
        AFRAME.registerComponent('treeman', {
          init: function(){
              let el = this.el;
              let self = this;

              el.addEventListener("changecolor", e =>{
                console.log(colorr);
                var color;

                switch (colorr) {
                  case "red":
                    color = "rgb(224, 0, 0)"
                    break;
                  case "green":
                    color = "rgb(15, 224, 0)"
                    break;
                  case "black":
                    color = "rgb(0, 0, 0)"
                    break;
                  case "blue":
                    color = "rgb(0, 32, 148)"
                    break;
                  case "yellow":
                    color = "rgb(182, 224, 27)"
                    break;
                  case "purple":
                    color = "rgb(2205, 27, 224)"
                    break;
                  case "orange":
                    color = "rgb(224, 145, 27)"
                    break;
                  case "brown":
                    color = "rgb(61, 39, 6)"
                    break;
                  case "white":
                    color = "rgb(255, 255, 255)"
                    break;
                  case "pink":
                    color = "rgb(217, 22, 207)"
                    break;
                  case "lime":
                    color =  "rgb(72, 232, 60)"
                    break;
                  case "grey":
                    color = "rgb(59, 59, 59)"
                    break;
                }
                console.log(color);

                let tree3D = el.getObject3D('mesh'); // Get THREEjs object from GLTF model
                if (!tree3D){return;}    
                // Traverse through each THREEjs model node
                tree3D.traverse(function(node){
                  if (node.isMesh){ // If current node is mesh change its material's color to provided color
                    node.material.color = new THREE.Color(color);
                    }
                })
              })
          }})

        function changeBaseCharacterColor(color) {
          let base_character = document.getElementById("base_character");

          colorr = color;
          localStorage.setItem("player_color", colorr)

          base_character.emit("changecolor");
        }
      </script>

      <!-- Light above base character model in customization area -->
      <a-light
        type="point"
        color="white"
        position="-1.5 4.45 -7"
        intensity="2.9"
      ></a-light>

      <!-- Stand for base character model -->
      <a-cylinder id="stand" position="0 1 -11" height="0.2" color="#4287f5" visible="false"></a-cylinder>

      <!-- Player model with preloaded backpacks and masks and base character -->
      <a-entity
      id = "player"
      position="0 1.1 -11"
      rotation="0 0 0"
      scale="0.7 0.7 0.7"
      visible="false"
      animation="startEvents: startanim; pauseEvents: pauseanim; resumeEvents: resumeanim; property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear"
      ><a-entity
        position="0 0 0"
        rotation="0 0 0"
        id="base_character"
        scale="1 1 1"
        animation-mixer="clip:Idle"
        gltf-model="#base_character_gltf"
        treeman
      ></a-entity>
      <a-entity
        position="0 1.8 -0.5"
        rotation="0 0 0"
        id="no_mask"
        scale="6 6 6"
        visible="true"
      ></a-entity>
      <a-entity
        position="0 3.027 0.307"
        rotation="0 0 0"
        id="mask_1_m"
        scale="0.002 0.002 0.002"
        gltf-model="#mask_1"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 3.055  0.25"
        rotation="0 0 0"
        id="mask_2_m"
        scale="0.0005 0.0005 0.0005"
        gltf-model="#mask_2"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 2.995 0.337"
        rotation="0 0 0"
        id="mask_3_m"
        scale="2 2 2"
        gltf-model="#mask_3"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 3.056 0.333"
        rotation="90 0 0"
        id="mask_4_m"
        scale="0.2 0.2 0.2"
        gltf-model="#mask_4"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 2.805 0.346"
        rotation="0 0 0"
        id="mask_5_m"
        scale="0.3 0.3 0.3"
        gltf-model="#mask_5"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 1.8 -0.5"
        rotation="0 0 0"
        id="no_backpack"
        scale="6 6 6"
        visible="true"
      ></a-entity>
      <a-entity
        position="0 1.8 -0.5"
        rotation="0 0 0"
        id="backpack_1_m"
        scale="6 6 6"
        gltf-model="#backpack_1"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 2 -0.212"
        rotation="0 180 0"
        id="backpack_2_m"
        scale="1 1 1"
        gltf-model="#backpack_2"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 2.145 -0.206"
        rotation="0 0 0"
        id="backpack_3_m"
        scale="0.01 0.01 0.01"
        gltf-model="#backpack_3"
        visible="false"
      ></a-entity>
      <a-entity
        position="0 2.215 -0.360"
        rotation="0 180 0"
        id="backpack_4_m"
        scale="1 1 1"
        gltf-model="#backpack_4"
        visible="false"
      ></a-entity>
      </a-entity>

      <!-- MilkyWay background -->
      <a-sky id="background" src="#background"></a-sky>

      <script>
        const mask_models = [
          "no_mask",
          "mask_1_m",
          "mask_2_m",
          "mask_3_m",
          "mask_4_m",
          "mask_5_m",
        ];
        const backpack_models = [
          "no_backpack",
          "backpack_1_m",
          "backpack_2_m",
          "backpack_3_m",
          "backpack_4_m",
        ];
        var current_mask_index = 0;
        var current_backpack_index = 0;

        function nextMask() {
          let current_mask = document.getElementById(
            mask_models[current_mask_index]
          );
          current_mask.setAttribute("visible", "false");

          current_mask_index = (current_mask_index + 1) % 6;
          let next_mask = document.getElementById(
            mask_models[current_mask_index]
          );
          next_mask.setAttribute("visible", "true");

          let scale = next_mask.getAttribute("scale");
          let new_scale = {x: scale.x/3, y: scale.y/3, z: scale.z/3};
          console.log(new_scale);

          mask_obj = {model: next_mask.getAttribute("gltf-model"), 
          position: next_mask.getAttribute("position"), 
          rotation: next_mask.getAttribute("rotation"), 
          scale: new_scale};
          localStorage.setItem("mask", mask_obj);
          console.log(mask_obj);
        }

        function prevMask() {
          let current_mask = document.getElementById(
            mask_models[current_mask_index]
          );
          current_mask.setAttribute("visible", "false");

          current_mask_index = (6 + current_mask_index - 1) % 6;
          let prev_mask = document.getElementById(
            mask_models[current_mask_index]
          );
          prev_mask.setAttribute("visible", "true");

          let scale = prev_mask.getAttribute("scale");
          let new_scale = {x: scale.x/3, y: scale.y/3, z: scale.z/3};

          mask_obj = {model: prev_mask.getAttribute("gltf-model"), 
          position: prev_mask.getAttribute("position"), 
          rotation: prev_mask.getAttribute("rotation"), 
          scale: new_scale};
          localStorage.setItem("mask", mask_obj);
          console.log(mask_obj);
        }

        function nextBackpack() {
          let current_backpack = document.getElementById(
            backpack_models[current_backpack_index]
          );
          current_backpack.setAttribute("visible", "false");

          current_backpack_index = (current_backpack_index + 1) % 5;
          let next_backpack = document.getElementById(
            backpack_models[current_backpack_index]
          );
          next_backpack.setAttribute("visible", "true");

          let scale = next_backpack.getAttribute("scale");
          let new_scale = {x: scale.x/3, y: scale.y/3, z: scale.z/3};

          backpack_obj = {model: next_backpack.getAttribute("gltf-model"), 
          position: next_backpack.getAttribute("position"), 
          rotation: next_backpack.getAttribute("rotation"), 
          scale: new_scale};
          localStorage.setItem("backpack", backpack_obj);
          console.log(backpack_obj);
        }

        function prevBackpack() {
          let current_backpack = document.getElementById(
            backpack_models[current_backpack_index]
          );
          current_backpack.setAttribute("visible", "false");

          current_backpack_index = (5 + current_backpack_index - 1) % 5;
          let prev_backpack = document.getElementById(
            backpack_models[current_backpack_index]
          );
          prev_backpack.setAttribute("visible", "true");

          let scale = prev_backpack.getAttribute("scale");
          let new_scale = {x: scale.x/3, y: scale.y/3, z: scale.z/3};

          backpack_obj = {model: prev_backpack.getAttribute("gltf-model"), 
          position: prev_backpack.getAttribute("position"), 
          rotation: prev_backpack.getAttribute("rotation"), 
          scale: new_scale};
          localStorage.setItem("backpack", backpack_obj);
          console.log(backpack_obj);
        }
      </script>
    </a-scene>
  </body>
</html>
